<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Random Quran Ayah</title>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css'>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div id="app"></div>
  <script src="https://unpkg.com/react@17.0.2/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17.0.2/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.12.4/babel.min.js"></script>
  <script type="text/babel" src="./script.js"></script>
  <script type="text/babel" id="components">
   import * as React from 'https://esm.sh/react';
   import * as ReactDOM from 'https://esm.sh/react-dom';

const ayatNumber = () => {
  const ayat = Math.floor(Math.random() * 6236 + 1);
  return ayat;
};

const QuoteBox = () => {
  const [quote, setQuote] = React.useState('');
  const [refference, setRefference] = React.useState('');

  const fetchQuote = async () => {
    try {
      const response = await fetch(`https://api.alquran.cloud/v1/ayah/${ayatNumber()}/en.asad`);
      if (!response.ok) {
        throw new Error(`HTTP error status: ${response.status}`);
      }
      const { text, surah, numberInSurah } = await response.json();
      console.log(surah.englishName);
      setQuote(text);
      setRefference(surah.englishName + " " + surah.englishNameTranslation + " " + surah.number + ":" + numberInSurah);
    } catch (error) {
      console.error(error);
      setQuote('Failed to fetch quote');
      setRefference('');
    }
  };

  React.useEffect(() => {
    fetchQuote();
  }, []);

  const handleNewQuote = () => {
    fetchQuote();
  };

  return (
    <React.Fragment>
      <h1>Random Quran Ayah</h1>
      <div id="quote-box" className="box">
        <div id="text" className="text">
          {quote}
        </div>
        <div id="author" className="author">
          - <span>{refference}</span>
        </div>
        <div className="actions">
          <button id="new-quote" className="button" onClick={handleNewQuote}>
            Refresh
          </button>
          <a href="twitter.com/intent/tweet" id="tweet-quote" className="button">
            Tweet Ayah
          </a>
        </div>
      </div>
    </React.Fragment>
  );
};

const App = () => (
  <div className="main" id="wrapper">
    <QuoteBox />
  </div>
);

export { App, QuoteBox };
</script>
</body>
</html>
